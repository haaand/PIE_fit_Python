# -*- coding: utf-8 -*-
"""
Created on Mon Feb 19 13:06:37 2024

@author: haakande
"""
import numpy as np
import PIE_sample_info as SI
import matplotlib.pyplot as plt

def PIE_fit(R0,p,F36_RT,F18_RT,MFR =SI.molar_flow_rate ,SSA = SI.S):
    calc = []
    for i in range(len(R0)):
        f36_calc = (((((1-p[i])**2)*(F18_RT**2))/(1-2*p[i]))*np.exp((-2*R0[i]*SSA)/MFR))+((F36_RT-((((1-p[i])**2)*(F18_RT**2))/(1-2*p[i])))*np.exp((-R0[i]*SSA)/(MFR*p[i])))
        calc.append(f36_calc)
    return calc

test = 1

if test == 1:
    r0 = [1.22506532176522e-07,3.02543459029532e-07,2.43540731407364e-07,5.01604138868183e-07,1.08334195587854e-06,2.15738354317601e-06,3.71288476667955e-06,7.28722133677168e-06,1.21248583454013e-05,1.92803513126281e-05]
    p= [0.999000000000000,0.937235178162440,0.827145475803472,0.713921385417565,0.634110667238477,0.517855741575773,0.418266340421039,0.632997838699833,0.705444052607219,0.809917470289684]
    f36_rt = 1.0011
    f18_rt = 1.0005
    
    test_c = PIE_fit(r0, p, f36_rt, f18_rt)
    f36_real = [0.977351265657701,
                0.941224252580107,
                0.947477212806269,
                0.885089208668032,
                0.754621977717113,
                0.538327720353448,
                0.310273276612532,
                0.139826599148510,
                0.0454108393849400,
                0.0119238100710568]
    
    
    plt.plot(test_c,'o')
    plt.plot(f36_real)
    plt.show()
    